<html>

<head>
    
    <!-- Libs -->
    <script src="../../Libraries/YUI/yahoo/yahoo.js" type="text/javascript"></script>
    <script src="../../Libraries/YUI/dom/dom.js" type="text/javascript"></script>
    <script src="../../Libraries/YUI/event/event.js" type="text/javascript"></script>
    <script src="../../Libraries/YUI/container/container.js" type="text/javascript"></script>
    <script src="../../Libraries/YUI/menu/menu.js" type="text/javascript"></script>
    <script src="../../Libraries/jQuery/jquery-1.10.2.min.js" type="text/javascript"></script>
    <script type="text/javascript" src="../../Libraries/soundmanager2/script/soundmanager2.js"></script>
    <script type="text/javascript" src="../../Libraries/q/q.js"></script>

    <!-- Utils -->
    <script type="text/javascript" src="../../Utilities/util.js"></script>
    <script type="text/javascript" src="../../Utilities/util_object.js"></script>
    <script type="text/javascript" src="../../Utilities/util_date.js"></script>
    <script type="text/javascript" src="../../Utilities/util_string.js"></script>
    <script type="text/javascript" src="../../Utilities/util_function.js"></script>
    <script type="text/javascript" src="../../Utilities/util_array.js"></script>
    <script type="text/javascript" src="../../Utilities/util_structs.js"></script>
    <script type="text/javascript" src="../../Utilities/util_dom.js"></script>
    <script type="text/javascript" src="../../Utilities/util_event.js"></script>
    <script type="text/javascript" src="../../Utilities/util_event_custom.js"></script>
    <script type="text/javascript" src="../../Utilities/util_event_emitter.js"></script>
    <script type="text/javascript" src="../../Utilities/util_event_manager.js"></script>
    <script type="text/javascript" src="../../Utilities/util_browser.js"></script>
    <script type="text/javascript" src="../../Utilities/util_frame.js"></script>
    <script type="text/javascript" src="../../Utilities/util_storage.js"></script>
    <script type="text/javascript" src="../../Utilities/util_xml.js"></script>

    <!-- TDS -->
    <script type="text/javascript" src="../../tools/tds.js"></script>
    <script type="text/javascript" src="../../tools/tds_zoom.js"></script>

    <!-- Resource Loader -->
    <script type="text/javascript" src="../../ResourceLoader/loader.js"></script>
    <script type="text/javascript" src="../../ResourceLoader/collection.js"></script>
    <script type="text/javascript" src="../../ResourceLoader/dependency.js"></script>
    <script type="text/javascript" src="../../ResourceLoader/conditional.js"></script>
    <script type="text/javascript" src="../../ResourceLoader/image.js"></script>
    <script type="text/javascript" src="../../ResourceLoader/binary.js"></script>
    <script type="text/javascript" src="../../ResourceLoader/script.js"></script>
    <script type="text/javascript" src="../../ResourceLoader/xhr.js"></script>

    <!-- Audio -->
    <script type="text/javascript" src="../../Audio/audio.js"></script>
    <script type="text/javascript" src="../../Audio/java.js"></script>
    <script type="text/javascript" src="../../Audio/services.js"></script>
    <script type="text/javascript" src="../../Audio/Recorder/recorder.js"></script>
    <script type="text/javascript" src="../../Audio/Player/player.js"></script>
    <script type="text/javascript" src="../../Audio/Player/player.queue.js"></script>
    
    <!-- Accommodations -->
    <script src="../../Accommodations/tds_acc.js" type="text/javascript"></script>
    <script src="../../Accommodations/tds_acc_type.js" type="text/javascript"></script>
    <script src="../../Accommodations/tds_acc_value.js" type="text/javascript"></script>
    <script src="../../Accommodations/tds_acc_props.js" type="text/javascript"></script>
    <script src="../../Accommodations/tds_acc_manager.js" type="text/javascript"></script>

    <!-- Content Manager -->
    <script src="../content_manager.js" type="text/javascript"></script>
    <script src="../content_utils.js" type="text/javascript"></script>
    <script src="../content_renderer.js" type="text/javascript"></script>
    <script src="../content_pages.js" type="text/javascript"></script>
    <script src="../content_page.js" type="text/javascript"></script>
    <script src="../content_entity.js" type="text/javascript"></script>
    <script src="../content_passage.js" type="text/javascript"></script>
    <script src="../content_item.js" type="text/javascript"></script>
    <script src="../content_component.js" type="text/javascript"></script>
    <script src="../content_response.js" type="text/javascript"></script>
    <script src="../content_legacy.js" type="text/javascript"></script>

    <script src="../content_menu.js" type="text/javascript"></script>
    <script src="../content_dialog.js" type="text/javascript"></script>
    <script src="../content_xml.js" type="text/javascript"></script>
    <script src="../content_frame.js" type="text/javascript"></script>
    <script src="../content_qti.js" type="text/javascript"></script>

    <script src="../content_keyboard.js" type="text/javascript"></script>

    <script src="../content_plugin.js" type="text/javascript"></script>
    <script src="../content_plugins.js" type="text/javascript"></script>
    <script src="../content_widget.js" type="text/javascript"></script>
    <script src="../content_widgets.js" type="text/javascript"></script>

    <!--

        -->
    <!--


        <script src="../content_item_tools.js" type="text/javascript"></script>
        <script src="../content_events.js" type="text/javascript"></script>
        -->


    <style type="text/css">
        .pageWrapper.hiding {
            display: none;
        }
    </style>
</head>

<body>
    
    Show/Hide: 
    <a class="togglePage" data-page="sample1" href="#">1</a>
    <a class="togglePage" data-page="sample2" href="#">2</a>
    <br/>
    <br/>
    <div id="contents"></div>

    <script type="text/javascript">

        (function(CM) {

            function match(page, content) {
                return true;
            }

            function Plugin(page, config) {
                Plugin.superclass.constructor.call(this, page, config);
            }

            CM.extendPlugin(Plugin);

            Plugin.prototype.exec = function () {
                console.info('Plugin run!');
            }

            CM.addPlugin(match, Plugin);


        })(ContentManager);


    </script>

    <script type="text/javascript">

        // setup aliases
        var CM = ContentManager;

        // initialize CM
        CM.init();

        // create pages collection
        var pages = CM.create('contents');

        // check for when someone creates
        pages.on('init', function(page) {

            console.log('Page Created: ', page);

            // wait for page to load
            page.on('loaded', function () {
                console.log('Page Loaded: ', page);
                // if no page set this
                if (pages.getCurrent() == null) {
                    page.show();
                }
            });

            // page show
            page.on('show', function () {
                console.log('Page Show: ', page);
            });

            // page hide
            page.on('hide', function() {
                console.log('Page Hide: ', page);
            });

            // get all page entities
            var entities = page.getEntities();
            entities.forEach(function (entity) {
                entity.on('focus', function() {
                    console.log('Entity Focus: ', entity);
                });
                entity.on('blur', function() {
                    console.log('Entity Blur: ', entity);
                });
            });
        });

        function loadContent(file) {
            $.getJSON(file)
                .done(function (content) {
                    // create a ContentPage object from json/xml response
                    var page = pages.create(content);
                    page.render();
                })
                .fail(function () {
                    console.error('Couldn\'t find or parse sample.');
                });
        }

        loadContent('sample1.js');
        loadContent('sample2.js');

        $('.togglePage').each(function(idx, el) {
            var $link = $(el);
            $link.click(function () {
                var page = pages.get($link.data('page'));
                if (page) {
                    page.isShowing() ? page.hide() : page.show();
                }
            });
        });

    </script>

</body>

</html>